def maze_module():
    """Модуль лабиринтов"""
    print("\n" + "=" * 50)
    print("МОДУЛЬ: ЛАБИРИНТЫ")
    print("=" * 50)
    
    # Определение всех 9 лабиринтов
    # Стены кодируются как: 'r' + номер ряда + номер колонки = стена снизу клетки
    #                       'c' + номер ряда + номер колонки = стена справа от клетки
    mazes = {}
    
    # Лабиринт 1: кружочки в (2,1) и (3,6)
    mazes[frozenset([(2, 1), (3, 6)])] = {
        'walls': {
            # Внешние стены
            'r0_1', 'r0_2', 'r0_3', 'r0_4', 'r0_5', 'r0_6',  # верх
            'r6_1', 'r6_2', 'r6_3', 'r6_4', 'r6_5', 'r6_6',  # низ
            'c1_0', 'c2_0', 'c3_0', 'c4_0', 'c5_0', 'c6_0',  # лево
            'c1_6', 'c2_6', 'c3_6', 'c4_6', 'c5_6', 'c6_6',  # право
            # Внутренние стены
            'c1_3', 'r1_2', 'r1_5', 'r1_6',
            'c2_1', 'r2_3', 'r2_4', 'r2_5',
            'c3_1', 'c3_3', 'r3_2',
            'c4_1', 'c4_4', 'r4_2', 'r4_3', 'r4_4', 'r4_5',
            'c5_3', 'c5_5', 'r5_2',
            'c6_2', 'c6_4'
        }
    }
    
    # Лабиринт 2: кружочки в (2,5) и (4,2)
    mazes[frozenset([(2, 5), (4, 2)])] = {
        'walls': {
            'r0_1', 'r0_2', 'r0_3', 'r0_4', 'r0_5', 'r0_6',
            'r6_1', 'r6_2', 'r6_3', 'r6_4', 'r6_5', 'r6_6',
            'c1_0', 'c2_0', 'c3_0', 'c4_0', 'c5_0', 'c6_0',
            'c1_6', 'c2_6', 'c3_6', 'c4_6', 'c5_6', 'c6_6',
            'c1_3', 'r1_1', 'r1_2', 'r1_6',
            'c2_2', 'c2_4', 'r2_3',
            'c3_1', 'c3_3', 'r3_2', 'r3_4', 'r3_5',
            'c4_2', 'c4_4', 'c4_5', 'r4_2',
            'c5_1', 'c5_2', 'c5_3', 'c5_5', 'r5_2',
            'c6_1', 'c6_3'
        }
    }
    
    # Лабиринт 3: кружочки в (4,4) и (4,6)
    mazes[frozenset([(4, 4), (4, 6)])] = {
        'walls': {
            'r0_1', 'r0_2', 'r0_3', 'r0_4', 'r0_5', 'r0_6',
            'r6_1', 'r6_2', 'r6_3', 'r6_4', 'r6_5', 'r6_6',
            'c1_0', 'c2_0', 'c3_0', 'c4_0', 'c5_0', 'c6_0',
            'c1_6', 'c2_6', 'c3_6', 'c4_6', 'c5_6', 'c6_6',
            'c1_3', 'c1_4', 'r1_2', 'r1_4',
            'c2_1', 'c2_2', 'c2_3', 'c2_5', 'r2_1',
            'c3_2', 'c3_3', 'c3_5', 'r3_1',
            'c4_1', 'c4_2', 'c4_3', 'c4_4', 'c4_5',
            'c5_1', 'c5_3', 'c5_4', 'c5_5', 'r5_2', 'r5_3',
            'c6_4'
        }
    }
    
    # Лабиринт 4: кружочки в (1,1) и (4,1)
    mazes[frozenset([(1, 1), (4, 1)])] = {
        'walls': {
            'r0_1', 'r0_2', 'r0_3', 'r0_4', 'r0_5', 'r0_6',
            'r6_1', 'r6_2', 'r6_3', 'r6_4', 'r6_5', 'r6_6',
            'c1_0', 'c2_0', 'c3_0', 'c4_0', 'c5_0', 'c6_0',
            'c1_6', 'c2_6', 'c3_6', 'c4_6', 'c5_6', 'c6_6',
            'c1_2', 'r1_2', 'r1_3', 'r1_4', 'r1_5',
            'c2_1', 'c2_2',
            'c3_1', 'c3_3', 'c3_5', 'r3_2', 'r3_3', 'r3_4',
            'c4_1', 'r4_2', 'r4_3', 'r4_4', 'r4_5',
            'c5_5', 'r5_2', 'r5_3', 'r5_4',
            'c6_2', 'c6_4'
        }
    }
    
    # Лабиринт 5: кружочки в (3,5) и (6,3)
    mazes[frozenset([(3, 5), (6, 3)])] = {
        'walls': {
            'r0_1', 'r0_2', 'r0_3', 'r0_4', 'r0_5', 'r0_6',
            'r6_1', 'r6_2', 'r6_3', 'r6_4', 'r6_5', 'r6_6',
            'c1_0', 'c2_0', 'c3_0', 'c4_0', 'c5_0', 'c6_0',
            'c1_6', 'c2_6', 'c3_6', 'c4_6', 'c5_6', 'c6_6',
            'r1_1', 'r1_2', 'r1_3', 'r1_4', 'r1_5',
            'c2_5', 'r2_2', 'r2_3',
            'c3_2', 'c3_3', 'r3_2', 'r3_4', 'r3_5',
            'c4_1', 'c4_4', 'c4_5',
            'c5_1', 'c5_5', 'r5_2', 'r5_3',
            'c6_1', 'r6_3', 'r6_4', 'r6_5'
        }
    }
    
    # Лабиринт 6: кружочки в (1,5) и (5,2)
    mazes[frozenset([(1, 5), (5, 2)])] = {
        'walls': {
            'r0_1', 'r0_2', 'r0_3', 'r0_4', 'r0_5', 'r0_6',
            'r6_1', 'r6_2', 'r6_3', 'r6_4', 'r6_5', 'r6_6',
            'c1_0', 'c2_0', 'c3_0', 'c4_0', 'c5_0', 'c6_0',
            'c1_6', 'c2_6', 'c3_6', 'c4_6', 'c5_6', 'c6_6',
            'c1_1', 'c1_3', 'r1_3', 'r1_4',
            'c2_1', 'c2_2', 'c2_3', 'c2_5',
            'c3_2', 'c3_3', 'c3_4', 'r3_2', 'r3_3', 'r3_4',
            'c4_2', 'c4_4', 'c4_5', 'r4_1',
            'c5_2', 'c5_3', 'c5_4', 'r5_2', 'r5_3',
            'c6_4'
        }
    }
    
    # Лабиринт 7: кружочки в (1,2) и (6,2)
    mazes[frozenset([(1, 2), (6, 2)])] = {
        'walls': {
            'r0_1', 'r0_2', 'r0_3', 'r0_4', 'r0_5', 'r0_6',
            'r6_1', 'r6_2', 'r6_3', 'r6_4', 'r6_5', 'r6_6',
            'c1_0', 'c2_0', 'c3_0', 'c4_0', 'c5_0', 'c6_0',
            'c1_6', 'c2_6', 'c3_6', 'c4_6', 'c5_6', 'c6_6',
            'c1_4', 'r1_2', 'r1_3',
            'c2_1', 'c2_3', 'c2_5', 'r2_3', 'r2_4', 'r2_5',
            'c3_2', 'c3_4', 'r3_1', 'r3_2',
            'c4_2', 'c4_5', 'r4_3', 'r4_4', 'r4_5',
            'c5_1', 'c5_2', 'c5_5', 'r5_2', 'r5_3', 'r5_4',
        }
    }
    
    # Лабиринт 8: кружочки в (1,4) и (4,3)
    mazes[frozenset([(1, 4), (4, 3)])] = {
        'walls': {
            'r0_1', 'r0_2', 'r0_3', 'r0_4', 'r0_5', 'r0_6',
            'r6_1', 'r6_2', 'r6_3', 'r6_4', 'r6_5', 'r6_6',
            'c1_0', 'c2_0', 'c3_0', 'c4_0', 'c5_0', 'c6_0',
            'c1_6', 'c2_6', 'c3_6', 'c4_6', 'c5_6', 'c6_6',
            'c1_1', 'c1_4', 'r1_3', 'r1_4',
            'c2_3', 'c2_5', 'r2_2', 'r2_3', 'r2_4', 'r2_5',
            'c3_1', 'c3_5',
            'c4_1', 'c4_3', 'r4_2', 'r4_3', 'r4_4',
            'c5_1', 'c5_2', 'r5_2', 'r5_3', 'r5_4', 'r5_5', 'r5_6',
        }
    }
    
    # Лабиринт 9: кружочки в (2,3) и (5,1)
    mazes[frozenset([(2, 3), (5, 1)])] = {
        'walls': {
            'r0_1', 'r0_2', 'r0_3', 'r0_4', 'r0_5', 'r0_6',
            'r6_1', 'r6_2', 'r6_3', 'r6_4', 'r6_5', 'r6_6',
            'c1_0', 'c2_0', 'c3_0', 'c4_0', 'c5_0', 'c6_0',
            'c1_6', 'c2_6', 'c3_6', 'c4_6', 'c5_6', 'c6_6',
            'c1_1', 'r1_3', 'r1_4',
            'c2_1', 'c2_2', 'c2_4', 'c2_5', 'r2_3',
            'c3_3', 'c3_5', 'r3_2', 'r3_3',
            'c4_1', 'c4_2', 'c4_4', 'r4_3', 'r4_4', 'r4_5',
            'c5_1', 'c5_2', 'c5_3', 'c5_5', 'r5_4',
            'c6_2', 'c6_4'
        }
    }
    
    print("\nВведите позиции кружочков на модуле.")
    print("Формат: ряд колонка (например: 1 5)")
    print("Ряды идут сверху вниз (1-6), колонки слева направо (1-6)\n")
    
    # Ввод позиций кружочков
    while True:
        try:
            circle1 = input("Первый кружочек (ряд колонка): ").strip().split()
            r1, c1 = int(circle1[0]), int(circle1[1])
            if 1 <= r1 <= 6 and 1 <= c1 <= 6:
                break
            print("⚠ Координаты должны быть от 1 до 6!")
        except:
            print("⚠ Неверный формат! Введите два числа через пробел")
    
    while True:
        try:
            circle2 = input("Второй кружочек (ряд колонка): ").strip().split()
            r2, c2 = int(circle2[0]), int(circle2[1])
            if 1 <= r2 <= 6 and 1 <= c2 <= 6:
                break
            print("⚠ Координаты должны быть от 1 до 6!")
        except:
            print("⚠ Неверный формат! Введите два числа через пробел")
    
    # Определяем лабиринт
    maze_key = frozenset([(r1, c1), (r2, c2)])
    
    if maze_key not in mazes:
        print("\n⚠ Лабиринт с такими кружочками не найден!")
        print("Проверьте правильность ввода координат")
        print("\nДоступные комбинации кружочков:")
        print("  Лабиринт 1: (2,1) и (3,6)")
        print("  Лабиринт 2: (2,5) и (4,2)")
        print("  Лабиринт 3: (4,4) и (4,6)")
        print("  Лабиринт 4: (1,1) и (4,1)")
        print("  Лабиринт 5: (3,5) и (6,3)")
        print("  Лабиринт 6: (1,5) и (5,2)")
        print("  Лабиринт 7: (1,2) и (6,2)")
        print("  Лабиринт 8: (1,4) и (4,3)")
        print("  Лабиринт 9: (2,3) и (5,1)")
        input("\nНажмите Enter для возврата в меню...")
        return
    
    maze = mazes[maze_key]
    print(f"\n✓ Лабиринт найден! Кружочки: ({r1},{c1}) и ({r2},{c2})")
    
    # Ввод текущей позиции и цели
    while True:
        try:
            start = input("\nВаша текущая позиция (ряд колонка): ").strip().split()
            start_r, start_c = int(start[0]), int(start[1])
            if 1 <= start_r <= 6 and 1 <= start_c <= 6:
                break
            print("⚠ Координаты должны быть от 1 до 6!")
        except:
            print("⚠ Неверный формат! Введите два числа через пробел")
    
    while True:
        try:
            goal = input("Целевая позиция (ряд колонка): ").strip().split()
            goal_r, goal_c = int(goal[0]), int(goal[1])
            if 1 <= goal_r <= 6 and 1 <= goal_c <= 6:
                break
            print("⚠ Координаты должны быть от 1 до 6!")
        except:
            print("⚠ Неверный формат! Введите два числа через пробел")
    
    # Поиск пути (BFS)
    from collections import deque
    
    def can_move(from_r, from_c, direction, walls):
        """Проверяет, можно ли переместиться в указанном направлении"""
        if direction == "ВВЕРХ":
            # Проверяем стену сверху текущей клетки
            return f'r{from_r - 1}_{from_c}' not in walls
        elif direction == "ВНИЗ":
            # Проверяем стену снизу текущей клетки
            return f'r{from_r}_{from_c}' not in walls
        elif direction == "ВЛЕВО":
            # Проверяем стену слева текущей клетки
            return f'c{from_r}_{from_c - 1}' not in walls
        elif direction == "ВПРАВО":
            # Проверяем стену справа текущей клетки
            return f'c{from_r}_{from_c}' not in walls
        return False
    
    # BFS для поиска кратчайшего пути
    queue = deque([(start_r, start_c, [])])
    visited = {(start_r, start_c)}
    
    moves = [
        (-1, 0, "ВВЕРХ"),
        (1, 0, "ВНИЗ"),
        (0, -1, "ВЛЕВО"),
        (0, 1, "ВПРАВО")
    ]
    
    while queue:
        r, c, path = queue.popleft()
        
        if r == goal_r and c == goal_c:
            # Путь найден!
            print("\n" + "=" * 50)
            print("ПУТЬ НАЙДЕН!")
            print("=" * 50)
            
            if not path:
                print("\n✓ Вы уже на месте!")
            else:
                print(f"\nШагов: {len(path)}")
                print("\nПуть:")
                for i, direction in enumerate(path, 1):
                    print(f"  {i}. {direction}")
            
            print("\n" + "=" * 50)
            input("\nНажмите Enter для возврата в меню...")
            return
        
        # Проверяем все направления
        for dr, dc, direction in moves:
            new_r, new_c = r + dr, c + dc
            
            # Проверяем границы
            if new_r < 1 or new_r > 6 or new_c < 1 or new_c > 6:
                continue
            
            # Проверяем, не посещали ли уже и есть ли стена
            if (new_r, new_c) not in visited and can_move(r, c, direction, maze['walls']):
                visited.add((new_r, new_c))
                queue.append((new_r, new_c, path + [direction]))
    
    # Путь не найден
    print("\n" + "=" * 50)
    print("⚠ ПУТЬ НЕ НАЙДЕН!")
    print("Проверьте правильность введенных координат")
    print("=" * 50)
    input("\nНажмите Enter для возврата в меню...")